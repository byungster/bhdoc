# 2. Vue 컴포넌트 (2019.10 ~ 2020.09)

레이아웃, 페이지, 컴포넌트 개발 경험 기록입니다.

## 사전 준비 : 가이드라인 정하기

리뉴얼된 서비스는 그에 걸맞는 새로운 요구사항에 의해 UI 구성요소와 기본 페이지가 개발됩니다.
특별한 기획의도가 있을 경우에는 UI 구성요소는 직접 만들어 사용해야하고
그 외에는 하이엔드(high-end)스러운 외부 컴포넌트들을 사용하는 것도 좋다고 생각합니다.
이러한 내용들부터 Vue에 대한 문법들까지 공식적인 우리들의 규칙을 정해야했습니다.

#### 1. Study

기존에 개발하던 습관 중에 어떤 습관을 버려야하는지, 어떤 습관을 들여야하는지 
무엇을 알고 개발해야하는지 등등을 학습하는 것이 급선무였습니다.

주 3일은 스터디에 시간을 할애하였습니다.

<StudyProcess/>

- Vue로 UI를 만드는 일을 쉽게 생각하기
- 누락된 지식은 없는지 교차 검증하기

Vue를 경험했던 인력이 없었기에, 위 2가지에 대해 확실하게 짚고가기 위해 노력했었고,
Official 사이트 이외에 다른 레퍼런스는 각자가 추천해주는 것을 많이 접하고자 노력했습니다.
당장 각 담당자는 맡은 기능을 Vue로 구현을 시작하고 코드 리뷰를 진행하며 서로 모르는 것을 리뷰하며
시행착오를 통해 새로운 프레임워크를 습득하게 되었습니다.

#### 2. 각종 가이드 섭렵 및 작성

![img_1.png](https://imgur.com/pqPdNMv.png)

내가 지금 제대로하는 것인지 의문이 들때마다 레퍼런스할 수 있는 매뉴얼을 만들고
관리하며, 지속적으로 코딩 스타일을 통일할 수 있도록 노력하고 있습니다.


## 웹 어플리케이션 구축하기

#### Layout
##### 1. Header
- 모든 페이지에 공통으로 렌더링되지만, 자식 컴포넌트는 메인 컨테이너에 렌더링되어야하는 컴포넌트에 따라 다릅니다.
- 따라서 특정 자리에 대한 정의만 되어 있습니다 (왼쪽 상단 버튼, 오른쪽 상단 실시간 업데이트 상태, 왼쪽 하단 탭, 오른쪽 하단 버튼 그룹 등)
- 목록페이지인지, 디테일페이지인지에 따라서 자식 컴포넌트와 제어할 State들은 동적으로 결정됩니다.

###### 1.1 HeaderCommon
- 정말 기본적으로 자리만 차지하고 있는 정적인 문서에 어울릴만한 헤더 영역 컴포넌트입니다.
- 다양한 응용이 불가능한 프로토타입의 성격이 강합니다.

###### 1.2 HeaderCombo
- 사용자와의 인터랙션에 따라 다양한 Re-Rendering이 이뤄질 수 있도록 파생된 헤더 영역 컴포넌트입니다. 
- 다양한 응용이 가능하며, 목록페이지인지, 디테일페이지인지에 따라서 자식 컴포넌트와 제어할 State들은 동적으로 결정됩니다.
- Slot을 사용하여 개발할 수도 있고, 메인 컨테이너에 Mounted되는 컴포넌트에게 Object 타입의 데이터를 전달하여 Method, Data, Event를 처리하는 방법이 있습니다. 

##### 2. Container
- 각 페이지는 Container라는 정중앙에 위치하는 레이아웃에 자식 컴포넌트로 렌더링됩니다.
- view 폴더에 각각의 기능별 디렉토리를 만들어서 vue 파일로 저장합니다.
- 각 vue 페이지는 대응하는 vuex 모듈이 존재하고, 제어 센터 역할을 담당하므로 레이아웃에 영향을 주어야하는 데이터들도 포함합니다.

##### 3. LeftPanel
- 로그인 상태의 사용자가 가지고 있는 권한에 따라 각기 다른 메뉴 항목을 표시할 수 있습니다.

##### 4. Modal
- 모달(팝업)은 사용자의 인터랙션을 막기 위하면서도 중요한 정보를 제공하기 위해 쓰입니다.

##### 5. RightPanel
- 각 페이지가 Container에 자식 컴포넌트로 로딩된 이후에, 해당 페이지에서 제공하는 Data들을 변경할 수 있는 입력란을 제공하기 위해 만들어졌습니다.
- Modal과 다르게, 사용자의 인터랙션을 유지시키면서도 데이터 변경을 진행할 수 있도록 UI를 구성하고자 만들어졌습니다.

#### Component

개발에 기여한 컴포넌트에 대한 회고록입니다.

##### 1. Graph

###### 왜 만듦?
[회사에서 기획된 "Flowchart Editor"](/portfolio/experience/1-workflow-editor) 라는 것을 만들어야 했습니다.
코어 Model은 Graph 자료구조 기반이었습니다.

###### 어찌 만듦? 외부 라이브러리 조사
mxgraph를 사용했으며, 이는 XML 기반 그래프 컴포넌트입니다.
Flowchart Editor를 개발하기에는 인력과 시간이 매우 한정적이어서 a부터z까지 모두 개발하는 것은 무리가 있었습니다.  
따라서 기획팀의 요구사항에 50% 이상 만족하는 Library를 조사 및 선정하여, 연동하는 방식으로 개발을 진행하였습니다.

<GraphAnalysis/>

XML 기반이라함은, 그래프의 구성요소가 되는 노드와 엣지가 모두 &lt;cell&gt;이라는 xml 태그로 표현되기 때문입니다.
1개 이상의 &lt;cell&gt;은 &lt;model&gt;로 감싸집니다.  
이는 javascript의 DOMParser.parseFromString을 이용하여 각 xml 노드인 &lt;cell&gt;을 html에 표현 가능한 svg요소로 렌더링합니다.

각각의 스타일을 입히고, 리스너를 등록하여 프로퍼티를 세부설정하거나 실시간으로 저장되게 동작시킵니다.

###### 주요 기능

기본 CRUD 이외에 주요 기능은 다음과 같습니다.
- 줌
- 드래그드랍
- 패닝
- 정렬/복사/붙여넣기

:::tip mxgraph?
구글의 문서 도구 중, draw.io 라는 다이어그래밍 도구가 있습니다.  
가령 Zoom/Minimap/DragDrop 기능 뿐만 아니라, 사용자의 이벤트와 관련된 여러가지 이벤트를 구현한 오픈소스 라이브러리입니다.  
SVG Elements 기반이며, 자세한 사항은 [컴포넌트 개발 > Graph](/portfolio/experience/2-componentize-on-vue#Graph) 영역에서 설명하였습니다.
:::

###### vue 컴포넌트에서 mxgraph 임포트하기

mxGraph라는 오픈소스 라이브러리를 활용하는 Graph 컴포넌트를 개발하게 되었습니다.
Graph 컴포넌트는 모두 js로 작성하였으며
vue와 연동하기 위하여 다음과 같이 설계하였습니다.

그 결과, 성공적으로 Loading 할 수 있었습니다.

###### 결과물?

특히, Graph의 Model에 대한 Cell의 생성/조회/수정/삭제는 Controller가 담당합니다.
따라서 Graph의 Model, View, 그리고 Controller 에서 Cell의 생성/조회/수정/삭제를 담당하는 UI 개발을 담당하였습니다.

#### Textarea

SMS 콘텐츠를 Edit하는 기능입니다.
Textarea의 입력 리스너를 커스텀하여 제작되었습니다.
여러가지 검사 (스팸워드, 글자수 길이, Coupon 번호, 외부 Text, URL 등의 가변적인 contents를 삽입할 수 있도록 하는 기능)
별도로 추가되어 수정이 불가능하도록 만드는 작업이 가장 까다로웠습니다.
SelectionStart, End 처리
